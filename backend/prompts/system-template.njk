{%- if include_role_and_expertise %}
====================================
{{ role_header | default("ROLE AND EXPERTISE") }}
====================================
{{ role_intro }} {{ role_description }}
{%- endif %}

{%- if include_final_request %}
====================================
{{ task_header | default("DYNAMIC TASK - USER REQUEST") }}
====================================
{{ task_static_intro }}

{{ final_request }}

{%- if include_format_instructions %}
{{ task_format_reminder }}
{%- endif %}
{%- endif %}

{%- if include_format_instructions %}
====================================
{{ format_header | default("FORMAT INSTRUCTIONS") }}
====================================
Format: {{ format_name }}

Instructions:
{%- for instr in format_instructions %}
- {{ instr }}
{%- endfor %}

Examples:
{%- for ex in format_examples %}
{{ ex }}
{%- endfor %}
{%- endif %}

{%- if include_project_info %}
====================================
{{ project_info_header | default("PROJECT INFORMATION") }}
====================================
Project Name: {{ project_name }}
Workspace Path: {{ workspace_path }}
{%- if project_info and project_info.trim() %}

{{ project_info }}
{%- endif %}
{%- endif %}

{%- if include_structure %}
====================================
{{ structure_header | default("PROJECT STRUCTURE") }}
====================================
{{ project_structure }}
{%- endif %}

{%- if include_code_content %}
====================================
{{ code_content_header | default("CODE CONTENT") }}
====================================
{%- for file_item in code_files %}
File: {{ file_item.path }}
Language: {{ file_item.language }}

`窶義窶義{{ file_item.language }}
{%- for line in file_item.lines %}
{{ line.text }}
{%- endfor %}
`窶義窶義

{%- if not loop.last %}

{{ file_separator | default("---------------------------------------------------------------------------") }}
{%- endif %}
{%- endfor %}
{%- endif %}
